experiment_name: "ttt"
seed: 42

data:
  source_img_dir: "data/source/galaxy_images_rgb"
  source_labels: "data/source/source_galaxy_labels.csv"
  target_img_dir: "data/target/gz2_images"
  target_labels: "data/target/gz2_galaxy_labels.csv"
  include_rotations: false
  shared_norm: false
  use_sampler: false
  image_size: [224, 224]
  batch_size: 32
  val_size: 0.2
  num_workers: 4

model:
  type: "resnet"
  arch: "resnet18"
  pretrained: true
  trainable_layers: 2
  dropout: 0.3

training:
  method: "mmd"
  num_epochs: 200
  warmup_epochs: 8
  lr: 1e-4
  optimizer: "adamw"
  weight_decay: 1e-2
  max_norm: 10.0
  lr_scheduler: "cosine"
  min_lr: 1e-6
  
  criterion: "focal"
  use_class_weights: true
  class_weight_method: "effective"
  class_weight_beta: 0.9999
  focal_gamma: 2.0
  focal_alpha: "class_weights"
  focal_reduction: "mean"
  
  early_stopping_patience: 8
  early_stopping_metric: "train_loss"
  
  # ========================================
  # MMD Domain Adaptation Settings
  # ========================================
  lambda_da: 0.1
  sinkhorn_blur: 10.0
  sinkhorn_p: 2
  
  # entropy minimization
  lambda_entropy: 0.02

  # No trainable weights or sigma schedule
  use_trainable_weights: false
  use_sigma_schedule: false
  
  # ========================================
  # OT Alignment Loss (OTAlignmentLoss)
  # ========================================
  lambda_ot: 0.5
  
  ot_lambda_ot: 0.3  # weight for sinkhorn OT distance
  ot_lambda_match: 0.6  # weight for matched-pair alignment (most important)
  ot_lambda_topk: 0.1  # weight for top-k worst pairs penalty
  
  # sinkhorn algorithm parameters
  ot_epsilon: 0.05  # regularization
  ot_n_iter: 50  # sinkhorn iterations
  
  # matching algorithm parameters
  match_epsilon: 0.05  # regularization
  match_n_iter: 20  # matching iterations
  ot_topk: 5  # number of worst pairs to penalize

output:
  root_dir: "ota_experiments/resnet"

